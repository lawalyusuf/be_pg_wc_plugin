jQuery(function(e){let a=!1;function o(){let e={};return wc_hydrogen_params.card_channel&&(wc_hydrogen_params.banks_allowed&&(e.banks=wc_hydrogen_params.banks_allowed),wc_hydrogen_params.cards_allowed&&(e.card_brands=wc_hydrogen_params.cards_allowed)),e}function t(){let e=[];return wc_hydrogen_params.bank_channel&&e.push("bank"),wc_hydrogen_params.card_channel&&e.push("card"),wc_hydrogen_params.ussd_channel&&e.push("ussd"),wc_hydrogen_params.qr_channel&&e.push("qr"),wc_hydrogen_params.bank_transfer_channel&&e.push("bank_transfer"),e}function r(){e("#wc-hydrogen-form").hide();let r=e("form#payment-form, form#order_review"),d;r.find("input.hydrogen_txnref").val("");let i=Number(wc_hydrogen_params.amount),l=function(o){r.append('<input type="hidden" class="hydrogen_txnref" name="hydrogen_txnref" value="'+o.reference+'"/>'),a=!0,r.submit(),e("body").block({message:null,overlayCSS:{background:"#fff",opacity:.6},css:{cursor:"wait"}})},s,c={key:wc_hydrogen_params.key,email:wc_hydrogen_params.email,amount:i,ref:wc_hydrogen_params.txnref,currency:wc_hydrogen_params.currency,subaccount:"",bearer:"",transaction_charge:"",metadata:{custom_fields:(s=[{display_name:"Plugin",variable_name:"plugin",value:"woo-hydrogen"}],wc_hydrogen_params.meta_order_id&&s.push({display_name:"Order ID",variable_name:"order_id",value:wc_hydrogen_params.meta_order_id}),wc_hydrogen_params.meta_name&&s.push({display_name:"Customer Name",variable_name:"customer_name",value:wc_hydrogen_params.meta_name}),wc_hydrogen_params.meta_email&&s.push({display_name:"Customer Email",variable_name:"customer_email",value:wc_hydrogen_params.meta_email}),wc_hydrogen_params.meta_phone&&s.push({display_name:"Customer Phone",variable_name:"customer_phone",value:wc_hydrogen_params.meta_phone}),wc_hydrogen_params.meta_billing_address&&s.push({display_name:"Billing Address",variable_name:"billing_address",value:wc_hydrogen_params.meta_billing_address}),wc_hydrogen_params.meta_shipping_address&&s.push({display_name:"Shipping Address",variable_name:"shipping_address",value:wc_hydrogen_params.meta_shipping_address}),wc_hydrogen_params.meta_products&&s.push({display_name:"Products",variable_name:"products",value:wc_hydrogen_params.meta_products}),s)},onSuccess:l,onCancel:function(){e("#wc-hydrogen-form").show(),e(this.el).unblock()}};wc_hydrogen_params.meta_order_id;let m=window.location.href;var p={amount:i,email:wc_hydrogen_params.email,currency:wc_hydrogen_params.currency,description:"Payment for items ordered with ID "+wc_hydrogen_params.meta_order_id,meta:wc_hydrogen_params.meta_name,callback:m};function u(){T.click(),window.location.href="/cart"}Array.isArray(t())&&t().length&&(c.channels=t(),e.isEmptyObject(o())||(c.metadata.custom_filters=o()));var y=new URLSearchParams(window.location.search),h=y.get("TransactionRef");y.get("key");var f=window.location.href,$=f.indexOf("key=");if(-1!==$){var g=f.substring($),b=g.indexOf("?");-1!==b&&(g=g.substring(0,b)),g.split("=")[1]}if(!h){var v=window.location.href,k=v.lastIndexOf("?");if(-1!==k)for(var x=v.substring(k+1).split("&"),w=0;w<x.length;w++){var _=x[w].split("=");if("TransactionRef"===_[0]){h=_[1];break}}}if(h){if(window!==window.parent)window.parent.postMessage({TransactionRef:h},"*");else{function S(a,o){let t=`
            <style>
                /* Style the modal overlay to cover the entire screen */
                .modal-overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.5); /* Semi-transparent background */
                    display: flex;
                    justify-content: center;
                    align-items: center;
                }
    
                /* Style the modal container */
                .hydrogen-modal-container {
                    background: #fff; /* White background color */
                    border-radius: 5px;
                    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3); /* Drop shadow */
                position: fixed;
                  top: 50%;
                  left: 50%;
                  transform: translate(-50%, -50%);
                  max-width: 1000px!important;
                  z-index: 1001;
                }
    
                /* Style the modal content */
                .modal-content {
                    padding: 20px;
                }
            </style>
            <div class="modal-overlay">
                <div class="hydrogen-modal-container">
                    <div class="modal fade" id="customModalSuccess" tabindex="-1" aria-labelledby="customModalLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="hydrogen-modal-body">
                                    <p>${a}</p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-primary" data-dismiss="modal" id="okButton">OK</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;e("body").append(t),e("#okButton").on("click",function(){window.location.href=o})}var C=wc_hydrogen_params.meta_order_id;wc_hydrogen_params.hydrogen_wc_redirect_url;var O=window.location.href.replace(/\/checkout\/order-pay\/\d+\/.*/,"");O+="/cart/",e.ajax({url:"/wc-api/wc_gateway_hydrogen",method:"POST",data:{transactionRef:JSON.stringify(h),hydrogenOderId:C},dataType:"json",beforeSend:function(){},success:function(e){if("90000"==e.statusCode){B.style.display="none";var a="Your payment for order #"+C+" is successful and confirmed! Check your email or account for order details.";S(a,O)}else{B.style.display="none";var a="Your payment for order #"+C+" was declined with status: Failed ! Click Ok.";S(a,O)}},error:function(a,o,t){console.log("Error:",o,t),e("#loading-spinner").hide()}})}}else e.ajax({url:"/wc-api/hydrogen_wc_payment",method:"POST",data:{hydrogen_pay:JSON.stringify(p)},dataType:"json",success:function(e){if("90000"==e.statusCode){var a;transactionRef=e.data.transactionRef,a=e.data.url,P&&L(),P=!0,R.src=a,B.style.display="block",I.style.display="block"}else console.log("Error Message: ",e.message),console.log("Error Message: ",e),confirm("Network error. Would you like to refresh the page ?")&&location.reload()},error:function(e,a,o){console.log("Error:",a,o),alert("Network error. Please refresh the page and try again later.")}});var E=`
          <style>
              .modal-overlay {
                  position: fixed;
                  top: 0;
                  left: 0;
                  width: 100%;
                  height: 100%;
                  background-color: rgba(0, 0, 0, 0.5);
                  z-index: 1000;
              }
          
              .modal-container {
                  position: fixed;
                  top: 50%;
                  left: 50%;
                  transform: translate(-50%, -50%);
                  max-width: 1000px!important;
                  z-index: 1001;
              }
          
              .custom-modal-body {
                  padding: 0px;
              }
          
              .modal-logo {
                  width: auto;
                  height: 150px;
                  margin-right: 10px;
              }

              .close {
                position: absolute;
                right: -1px;
                top: 29px;
                padding: 5px 7px!important;
              }

              #loading-spinner {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(255, 255, 255, 0.8);
                display: none;
                justify-content: center;
                align-items: center;
                z-index: 9999;
            }
            
            .spinner {
                border: 4px solid rgba(255, 255, 255, 0.3);
                border-top: 4px solid #0073aa; /* Change the color of the spinner */
                border-radius: 50%;
                width: 40px;
                height: 40px;
                animation: spin 2s linear infinite;
            }
            
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
            
          </style>
          `;e("head").append(E);var j=`
          <div class="modal-overlay"></div>
          `;e("body").append(j);var M=`
          <div class="modal-container">
              <div class="modal fade" id="linkModal" tabindex="-1" aria-labelledby="linkModalLabel" aria-hidden="true">
                  <div class="modal-dialog modal-lg">
                      <div class="modal-content max-w-650px">
                          <div class="modal-header">
                              <img src="https://qa-gateway.hydrogenpay.com/_next/static/media/Logo.9a9207a9.svg" alt="Logo" class="modal-logo">
                                    
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                              </button>
                          </div>
                          <div class="modal-body custom-modal-body">
                              <iframe id="linkIframe" style="width: 150%; height: 400px; border: none;"></iframe>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
          
          `;e("body").append(M);var T=document.querySelector(".modal .close"),I=document.querySelector(".modal-overlay");function L(){B.style.display="none",I.style.display="none",e("#wc-hydrogen-form").show(),e(this.el).unblock();var a=wc_hydrogen_params.meta_order_id;e.ajax({url:"/wc-api/wc_gateway_hydrogen_popup",method:"POST",data:{transactionRef:JSON.stringify(transactionRef),hydrogenOderId:a},dataType:"json",beforeSend:function(){},success:function(e){var a=wc_hydrogen_params.meta_order_id,o=window.location.href.replace(/\/checkout\/order-pay\/\d+\/.*/,"");if(o+="/cart/","90000"==e.statusCode){B.style.display="none";var t="Your payment for order #"+a+" is successful and confirmed! Check your email or account for order details.";n(t,o)}else{B.style.display="none";var t="Your payment for order #"+a+" was declined with status: Failed ! Click Ok.";n(t,o)}},error:function(e,a,o){console.log("Error:",a,o)}})}var P=!1;T.addEventListener("click",L),I.addEventListener("click",L);var B=document.getElementById("linkModal"),R=document.getElementById("linkIframe");window.addEventListener("message",function(e){e.data&&e.data.TransactionRef&&T.click()})}function n(a,o){let t=`
    <style>
        /* Style the modal overlay to cover the entire screen */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5); /* Semi-transparent background */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Style the modal container */
        .hydrogen-modal-container {
            background: #fff; /* White background color */
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3); /* Drop shadow */
        position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          max-width: 1000px!important;
          z-index: 1001;
        }

        /* Style the modal content */
        .modal-content {
            padding: 20px;
        }
    </style>
    <div class="modal-overlay">
        <div class="hydrogen-modal-container">
            <div class="modal fade" id="customModalSuccess" tabindex="-1" aria-labelledby="customModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="hydrogen-modal-body">
                            <p>${a}</p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" data-dismiss="modal" id="okButton">OK</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
`;e("body").append(t),e("#okButton").on("click",function(){window.location.href=o})}e("#wc-hydrogen-form").hide(),r(),e("#hydrogen-payment-button").click(function(){wcHydrogenkFormHandler()}),e("#hydrogen_form form#order_review").submit(function(){r()})});